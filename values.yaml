# BD SelfScan Default Configuration Values
# Updated for GitHub Container Registry

# Global configuration
global:
  namespace: "bd-selfscan-system"

# Chart metadata
nameOverride: ""
fullnameOverride: ""

# RBAC configuration
rbac:
  create: true
  serviceAccount:
    create: true
    name: ""
    annotations: {}

# Black Duck configuration
blackduck:
  tokenSecretName: "blackduck-creds"
  trustCert: true

# On-demand scanning configuration (Phase 1)
onDemand:
  enabled: true

# Automated scanning configuration (Phase 2)
automated:
  enabled: false

# Scan target (for on-demand scanning)
scanTarget: ""

# Application configuration
applications: []

# ConfigMap configuration
configMap:
  applications:
    name: "bd-selfscan-applications"

# Scanner configuration
scanner:
  # Use GitHub Container Registry image
  # Replace 'your-github-username/your-repo-name' with your actual GitHub repository
  image: "ghcr.io/snps-steve/bd-selfscan/bd-selfscan:latest"
  imagePullPolicy: "Always"  # Always pull to get latest changes
  
  # Resource limits and requests
  resources:
    requests:
      memory: "2Gi"
      cpu: "500m"
      ephemeral-storage: "10Gi"
    limits:
      memory: "8Gi"
      cpu: "4"
      ephemeral-storage: "50Gi"
  
  # Job configuration
  job:
    backoffLimit: 3
    activeDeadlineSeconds: 3600
    ttlSecondsAfterFinished: 86400  # 24 hours
    parallelism: 1
    completions: 1
    # Pod-level security context - run as root for Black Duck operations
    securityContext:
      runAsUser: 0
      runAsGroup: 0
      fsGroup: 0
  
  # Container security context - more permissive for Black Duck scanning
  containerSecurityContext:
    allowPrivilegeEscalation: true
    readOnlyRootFilesystem: false
    runAsUser: 0
    capabilities:
      add:
        - CHOWN
        - DAC_OVERRIDE
        - FOWNER
        - SETGID
        - SETUID
        - SYS_ADMIN
      drop:
        - NET_RAW
  
  # Node selection
  nodeSelector: {}
  tolerations: []
  affinity: {}
  
  # Docker socket access
  dockerSocket:
    enabled: false

# Scanning configuration
scanning:
  projectTier: 3
  policyFailSeverities: "CRITICAL,BLOCKER"
  imageDownloadTimeout: 600
  imageDownloadRetries: 3
  scanTimeout: 1800

# Registry configuration - GitHub Container Registry authentication
registry:
  imagePullSecrets:
    - name: ghcr-secret  # Optional: for private repositories

# Debug configuration
debug:
  enabled: true
  logLevel: "INFO"
  keepTempFiles: false

# Monitoring configuration (Phase 2)
monitoring:
  enabled: false
  serviceMonitor:
    enabled: false
    namespace: ""
    labels: {}
    interval: "30s"
    scrapeTimeout: "10s"

# Controller configuration (Phase 2)
controller:
  enabled: false
  image: "python:3.11-slim"
  imagePullPolicy: "IfNotPresent"
  replicas: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  service:
    type: ClusterIP
    port: 8080
    targetPort: 8080
  metrics:
    enabled: true
    port: 8080
    path: "/metrics"
  health:
    enabled: true
    port: 8081
    path: "/health"

# Scheduled scanning configuration (Phase 2)
scheduled:
  enabled: false
  jobs: []

# Network policy configuration
networkPolicy:
  enabled: false
  ingress: []
  egress: []