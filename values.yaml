# BD SelfScan values.yaml - Updated to use custom image

scanner:
  # Use your custom-built image instead of installing tools at runtime
  image: "your-registry.com/bd-selfscan-scanner:latest"  # Update this!
  imagePullPolicy: Always
  
  # Resource requirements (can be lower since tools are pre-installed)
  resources:
    requests:
      memory: "2Gi"      # Reduced since no package installation
      cpu: "500m"        # Reduced startup time
      ephemeralStorage: "20Gi"
    limits:
      memory: "8Gi"      # Still need memory for scanning
      cpu: "4"           # Parallel processing
      ephemeralStorage: "50Gi"
  
  # Job configuration
  job:
    backoffLimit: 3
    activeDeadlineSeconds: 5400  # 1.5 hours
    ttlSecondsAfterFinished: 86400  # 24 hours
    parallelism: 1
    completions: 1
    
    # Security context - can run as non-root since tools are pre-installed
    securityContext:
      runAsNonRoot: true   # Changed: tools already installed
      runAsUser: 1000      # Changed: use scanner user
      runAsGroup: 1000
      fsGroup: 1000
      
  # Container security context
  containerSecurityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false  # Still need /tmp for scanning
    capabilities:
      drop:
        - ALL

# Registry configuration (if using private registry)
registry:
  imagePullSecrets:
    - name: "your-registry-secret"  # Add if needed

# Global configuration
global:
  namespace: "bd-selfscan-system"